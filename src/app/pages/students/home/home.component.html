<div class="row">
  <div class="col-md-7">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">{{ 'Schedule' | transloco }}</h4>
        <div class="row navigation text-center">
          <div class="col-md-4">
            <div class="btn-group">
              <div
                class="btn btn-primary btn-sm"
                mwlCalendarPreviousView
                [view]="view"
                [(viewDate)]="viewDate"
                (viewDateChange)="closeOpenMonthViewDay()"
                [excludeDays]="excludeDays"
              >
                <i class="fas fa-backward fa-fw" aria-hidden="true"></i>
              </div>
              <div
                class="btn btn-outline-secondary btn-sm"
                mwlCalendarToday
                [(viewDate)]="viewDate"
                (viewDateChange)="closeOpenMonthViewDay()"
              >
                {{ 'Today' | transloco }}
              </div>
              <div
                class="btn btn-primary btn-sm"
                mwlCalendarNextView
                [view]="view"
                [(viewDate)]="viewDate"
                (viewDateChange)="closeOpenMonthViewDay()"
                [excludeDays]="excludeDays"
              >
                <i class="fas fa-forward fa-fw" aria-hidden="true"></i>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <h5>
              {{
                viewDate
                  | calendarDate
                    : view + 'ViewTitle'
                    : 'es-PA'
                    : weekStartsOn
                    : excludeDays
              }}
            </h5>
          </div>
          <div class="col-md-4">
            <div class="btn-group">
              <div
                class="btn btn-primary btn-sm"
                (click)="setView(CalendarView.Week)"
                [class.active]="view === CalendarView.Week"
              >
                {{ 'Week' | transloco }}
              </div>
              <div
                class="btn btn-primary btn-sm"
                (click)="setView(CalendarView.Month)"
                [class.active]="view === CalendarView.Month"
              >
                {{ 'Month' | transloco }}
              </div>
            </div>
          </div>
        </div>
        <ng-template #loading>
          <div class="text-center">
            <sk-loading-modal></sk-loading-modal>
          </div>
        </ng-template>
        <div class="container-fluid">
          <div *ngIf="assignment$ | async; else loading; let events">
            <div [ngSwitch]="view">
              <mwl-calendar-month-view
                *ngSwitchCase="'month'"
                [viewDate]="viewDate"
                [events]="events"
                [weekStartsOn]="weekStartsOn"
                [activeDayIsOpen]="activeDayIsOpen"
                [excludeDays]="excludeDays"
                (dayClicked)="dayClicked($event.day)"
                (eventClicked)="selectDay($event.event)"
              >
              </mwl-calendar-month-view>
              <ng-container *ngSwitchCase="'week'">
                <div *ngIf="!isLoading; else loading" id="week-container">
                  <div *ngFor="let day of mapped" id class="card">
                    <div class="card-body">
                      <h5 class="card-title">{{ formatDate(day.date) }}</h5>
                      <div
                        class="day-container mb-4"
                        *ngFor="let task of day.assignments"
                      >
                        <div class="card-body">
                          <h6 class="card-title">
                            <span class="clear-text"
                              >[Docente: {{ task.teacher.name }}]</span
                            >
                            - {{ task.course?.subject.name }} /
                            {{ task.title }} -
                            <small class="clear-text">{{
                              task.type?.name
                            }}</small>
                          </h6>
                          <div [ngxSummernoteView]="task.description"></div>
                          <a [routerLink]="['..', 'assignments', task.id]" class="btn btn-primary">Ir a tarea</a>
                        </div>
                      </div>
                      <p
                        *ngIf="day.assignments.length === 0"
                        class="text-center regular-text"
                      >
                        {{ 'Without assignments' | transloco }}
                      </p>
                    </div>
                  </div>
                </div>
                <ng-template #loading>
                  <sk-loading-modal></sk-loading-modal>
                </ng-template>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-5">
    <ng-container *ngIf="currentSurveys | async as surveys">
      <div class="card" *ngIf="surveys.length > 0">
        <div class="card-body">
          <h4 class="card-title">{{ 'Surveys' | transloco }}</h4>
          <div
            *ngFor="let quiz of surveys"
            (click)="answerSurvey(quiz.id)"
            class="card quiz-card"
          >
            <div class="card-body">
              <h6 class="card-title">
                {{ quiz.title }}
              </h6>
              <i
                class="far fa-clock text-danger fa-lg fa-fw"
                aria-hidden="true"
              ></i>
              {{ 'Due time' | transloco }} {{ formatDue(quiz.endDate) }}
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="quizes$ | async as quizes">
      <div *ngIf="quizes.length > 0" class="card">
        <div class="card-body">
          <h4 class="card-title">{{ 'Quizes' | transloco }}</h4>
          <div
            *ngFor="let quiz of quizes"
            [routerLink]="['../quizes', quiz.id]"
            class="card quiz-card"
          >
            <div class="card-body">
              <h6 class="card-title">
                <span class="clear-text">{{ quiz.course.subject.name }}</span> -
                {{ quiz.quiz.name }}
              </h6>
              <i
                class="far fa-clock text-danger fa-lg fa-fw"
                aria-hidden="true"
              ></i>
              {{ 'Due time' | transloco }} {{ formatDue(quiz.endDate) }}
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">{{ 'Activities' | transloco }}</h4>
        <div class="activities-container">
          <div
            *ngFor="let activity of activities | async"
            class="card activity-card"
            [routerLink]="['../courses', activity.course.id]"
          >
            <div class="card-body">
              <h6 class="regular-text">
                <i
                  *ngIf="activity.type === 4"
                  class="fas fa-book-reader fa-fw fa-lg text-primary"
                  aria-hidden="true"
                ></i>
                <i
                  *ngIf="activity.type === 5"
                  class="far fa-file-pdf fa-fw fa-lg danger-text"
                  aria-hidden="true"
                ></i>
                {{ activity.course.subject.name }}
              </h6>
              <p class="ink-text">
                {{ activity.createDate | date: 'short' }}
              </p>
              <p class="small-text clear-text">{{ activity.description }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
